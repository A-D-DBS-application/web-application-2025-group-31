<!DOCTYPE html>
<html lang="nl">

<head>
    <meta charset="UTF-8">
    <title>Digest Instellingen</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>

<div class="layout">

    <div class="sidebar">
        <h2>RIVAL</h2>
        <div class="sidebar-tagline">Competitive Intelligence</div>
        <nav>
            <a href="{{ url_for('main.dashboard') }}">
                <span class="label"><span class="dot"></span><span>Dashboard</span></span>
            </a>
            <a href="{{ url_for('main.watchlist') }}">
                <span class="label"><span class="dot"></span><span>Watchlist</span></span>
            </a>
            <a href="{{ url_for('main.companies') }}">
                <span class="label"><span class="dot"></span><span>Bedrijven</span></span>
            </a>
            <a href="{{ url_for('main.weekly_mail_settings') }}" class="active">
                <span class="label"><span class="dot"></span><span>Newsletter</span></span>
            </a>
            <a href="{{ url_for('main.logout') }}">
                <span class="label"><span class="dot"></span><span>Uitloggen</span></span>
            </a>
        </nav>
        <div class="sidebar-footer">
            Rival MVP © 2025
        </div>
    </div>

    <div class="content fade-in">

        <div class="topbar">
            <div class="topbar-left">
                <h1>Digest Instellingen</h1>
                <div class="subtitle">Beheer uw wekelijkse e-mailnotificaties en inhoud</div>
            </div>
            <div class="topbar-right">
                <span class="badge-soft">Ingelogd als {{ session['username'] }}</span>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Instellingen Wekelijkse Digest</h2>
                <span class="card-meta">E-mailfrequentie en Signaaltypes</span>
            </div>

            <div class="card-body">
                <form action="{{ url_for('main.update_weekly_mail') }}" method="POST">

                    <div class="form-group">
                        <label for="frequency" class="form-label">
                            Frequentie
                        </label>
                        <select id="frequency" name="frequency" class="form-control">
                            
                            <option value="" {% if not user.digest_frequency or user.digest_frequency == '' %}selected{% endif %}>
                                Digest uitschakelen (Geen mails)
                            </option>
                            <option value="weekly" {% if user.digest_frequency == 'weekly' %}selected{% endif %}>
                                Wekelijks
                            </option>
                            <option value="biweekly" {% if user.digest_frequency == 'biweekly' %}selected{% endif %}>
                                Twee-wekelijks
                            </option>
                            <option value="monthly" {% if user.digest_frequency == 'monthly' %}selected{% endif %}>
                                Maandelijks
                            </option>
                        </select>
                        <small class="form-help">Kies hoe vaak u de samenvatting wilt ontvangen.</small>
                    </div>

                    <hr class="form-separator">

                    <div class="form-group">
                        <label class="form-label">
                            Gedetecteerde Signalen Opnemen
                        </label>

                        {% set available_signals = [
                            ('pricing_change', 'Prijs- en abonnementswijzigingen'),
                            ('new_feature', 'Nieuwe key features/producten'),
                            ('segment_change', 'Wijzigingen in het target segment/doelgroep'),
                            ('hiring', 'Aanzienlijke aanwervingen of groei van het team'),
                            ('funding', 'Nieuwe financieringsrondes of investeringen')
                        ] %}
                        
                        <div class="checkbox-group"> 
                            {% for value, label in available_signals %}
                                <label class="checkbox-container">
                                    <input 
                                        type="checkbox" 
                                        name="digest_signals"
                                        value="{{ value }}"
                                        {% if value in (user.digest_signals or []) %}checked{% endif %}
                                    >
                                    <span class="checkbox-label">{{ label }}</span>
                                </label>
                            {% endfor %}
                        </div>

                        <small class="form-help">Selecteer welke strategische veranderingen u wilt zien in de digest.</small>
                    </div>
                    
                    <hr class="form-separator">

                    <div class="info-block">
                        <p>
                            <strong>Bedrijven Selecteren:</strong> De bedrijven die in de digest worden opgenomen, worden beheerd op uw 
                            <a href="{{ url_for('main.watchlist') }}" class="text-link">**Watchlist pagina**</a>. 
                            Schakel daar de 'Digest'-optie per bedrijf in of uit.
                        </p>
                    </div>


                    <button type="submit" class="button" style="margin-top:20px;">
                        Instellingen Opslaan
                    </button>

                </form>
            </div>
        </div>


        <div class="card card-muted" style="margin-top: 24px;">
            <div class="card-header">
                <h2 class="card-title">Voorbeeld van wekelijkse mail</h2>
                <div class="card-meta">Dit is een preview van wat Rival u zou sturen, gebaseerd op uw voorkeuren.</div>
            </div>

            <div class="card-body">

                <p><strong>Weekly Competitive Digest</strong></p>
                <p class="subtitle" style="margin-bottom: 12px;">
                    Hier is een voorbeeld van hoe uw wekelijkse update eruit zou zien.
                </p>

                <ul class="soft-list">
                    <li>
                        <strong>CompetitorOne</strong><br>
                        • Nieuwe feature gelanceerd: “AI Analytics Dashboard”<br>
                        • Website traffic +12% volgens SimilarWeb<br>
                        • Hiring: 3 nieuwe engineering posities
                    </li>

                    <li>
                        <strong>CompetitorTwo</strong><br>
                        • Pricing update: Starter plan verhoogd van €29 → €39<br>
                        • 1 nieuwe review op TrustPilot (4 ★)<br>
                        • Blogpost: “Ons 2025 Product Vision”
                    </li>

                    <li>
                        <strong>Markttrends</strong><br>
                        • Funding: €18M Series A voor StartupX in dezelfde niche<br>
                        • Regulatory update: EU data-compliance wijziging vanaf juni 2025
                    </li>
                </ul>

                <p class="card-meta" style="margin-top: 12px;">
                    Opmerking: dit is een demo-voorbeeld.
                    De echte mails tonen enkel bedrijven uit uw watchlist met `digest_enabled = True` en de geselecteerde signaaltypes.
                </p>

            </div>
        </div>

    </div>

</div>

</body>
</html>




