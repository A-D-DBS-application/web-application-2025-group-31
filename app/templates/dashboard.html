  <!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Dashboard | Rival</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
<div class="layout">

    <!-- SIDEBAR -->
    <aside class="sidebar soft-shadow">
        <div>
            <h2>RIVAL</h2>
            <div class="sidebar-tagline">Competitive intelligence</div>
        </div>

        <nav>
            <a href="{{ url_for('main.dashboard') }}" class="active">
                <span class="label"><span class="dot"></span><span>Dashboard</span></span>
            </a>

            <a href="{{ url_for('main.watchlist') }}">
                <span class="label"><span class="dot"></span><span>Watchlist</span></span>
            </a>

            <a href="{{ url_for('main.companies') }}">
                <span class="label"><span class="dot"></span><span>Bedrijven</span></span>
            </a>

            <a href="{{ url_for('main.weekly_mail_settings') }}">
                <span class="label"><span class="dot"></span><span>Newsletter</span></span>
            </a>

            <a href="{{ url_for('main.logout') }}">
                <span class="label"><span class="dot"></span><span>Uitloggen</span></span>
            </a>
        </nav>

        <div class="sidebar-footer">
            Rival · v0.1 · Internal demo
        </div>
    </aside>

    <!-- MAIN -->
    <main class="content fade-in">

        <!-- TOP BAR -->
        <div class="topbar">
            <div class="topbar-left">
                <h1>Intelligence dashboard</h1>
                <p class="subtitle">Analyseer nieuwe websites, volg je watchlist en bekijk recente signalen.</p>
            </div>
        </div>

        <!-- STATISTIEKEN -->
        <div class="grid-3">
            <div class="stat-card">
                <div class="stat-label">Geanalyseerde websites</div>
                <div class="stat-value">–</div>
                <div class="stat-trend">Synchronisatie met Supabase later</div>
            </div>

            <div class="stat-card">
                <div class="stat-label">Actieve watchlist</div>
                <div class="stat-value">{{ watchlist|length if watchlist else 0 }}</div>
                <div class="stat-trend">Handmatige selectie</div>
            </div>

            <div class="stat-card">
                <div class="stat-label">Ongelezen alerts</div>
                <div class="stat-value">{{ alerts|length if alerts else 0 }}</div>
<<<<<<< Updated upstream
                <div class="stat-trend">Mock data</div>
=======
                <div class="stat-trend">Mock data – later live</div>
>>>>>>> Stashed changes
            </div>
        </div>

        <!-- SCRAPING + WATCHLIST OVERVIEW -->
        <div class="grid-2">

            <!-- SCRAPE SECTION -->
            <section class="card soft-shadow fade-in">
                <div class="card-header">
                    <h2 class="card-title">Nieuwe websiteanalyse</h2>
                    <div class="card-meta">Plak een URL, Rival doet de scan.</div>
                </div>

                <div class="card-body">

                    <!-- INPUT -->
                    <form method="POST" class="url-form">
                        <input type="hidden" name="form_type" value="scrape">
                        <input type="text" name="scrape_url" placeholder="https://voorbeeldbedrijf.nl" required>
                        <button type="submit" class="button" style="margin-top:10px;">Analyseren</button>
                    </form>

                    <!-- SCRAPE RESULT -->
                    {% if scrape_result %}
                        {% if scrape_result.error %}
                            <p class="alert">❌ {{ scrape_result.error }}</p>

                        {% else %}
                            <div class="fade-in" style="margin-top:18px;">
                                <h3>Resultaten voor {{ scrape_result.url }}</h3>

                                <p><strong>Titel:</strong> {{ scrape_result.title }}</p>
                                <p><strong>Omschrijving:</strong> {{ scrape_result.description }}</p>

                                {% if scrape_result.headings %}
                                    <p><strong>Belangrijke H1-koppen:</strong></p>
                                    <ul class="soft-list">
                                        {% for h in scrape_result.headings %}
                                            <li>{{ h }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}

                                <!-- ⭐ BASELINE REPORT ⭐ -->
                                <div class="card soft-shadow" style="margin-top:20px;">
                                    <div class="card-header">
                                        <h3 class="card-title">Baseline Report</h3>
                                        <div class="card-meta">Fundamentals automatisch gedetecteerd</div>
                                    </div>

                                    <div class="card-body">
                                        <p><strong>Headquarters:</strong><br>
                                            {{ scrape_result.headquarters or "Onbekend" }}</p>

                                        <p><strong>Office Locations:</strong><br>
                                            {{ scrape_result.office_locations or "Niet gevonden" }}</p>

                                        <p><strong>Team Size:</strong><br>
                                            {{ scrape_result.team_size or "Onbekend" }}</p>

                                        <p><strong>Total Funding:</strong><br>
                                            {% if scrape_result.funding %}
                                                €{{ scrape_result.funding }}
                                            {% else %}
                                                Onbekend
                                            {% endif %}
                                        </p>

                                        <p><strong>Funding History:</strong><br>
                                            {{ scrape_result.funding_history or "Geen informatie" }}</p>

                                        <p><strong>Traction Signals:</strong><br>
                                            {{ scrape_result.traction_signals or "Geen signalen gedetecteerd" }}</p>
                                    </div>
                                </div>
                                <!-- EINDE BASELINE -->
                            </div>
                        {% endif %}
                    {% endif %}

                </div>
            </section>

            <!-- WATCHLIST -->
            <section class="card card-muted soft-shadow fade-in">
                <div class="card-header">
                    <h2 class="card-title">Watchlist</h2>
<<<<<<< Updated upstream
                    <div class="card-meta">Overzicht van je gevolgde bedrijven.</div>
=======
                    <div class="card-meta">Overzicht van gevolgde websites</div>
>>>>>>> Stashed changes
                </div>

                <div class="card-body">
                    {% if watchlist %}
                        <ul class="soft-list">
                            {% for item in watchlist %}
                                <li>{{ item }}</li>
                            {% endfor %}
                        </ul>
<<<<<<< Updated upstream
                    {% else %}
                        <p class="subtitle">Nog geen bedrijven in watchlist.</p>
=======

                        {% if metrics_selected %}
                            <p><strong>Geselecteerde metrics:</strong> {{ metrics_selected|join(', ') }}</p>
                        {% endif %}
                    {% else %}
                        <p class="subtitle">Je hebt nog geen watchlist-items.</p>
>>>>>>> Stashed changes
                    {% endif %}
                </div>
            </section>

        </div>

        <!-- WATCHLIST CONFIG -->
        <section class="card soft-shadow fade-in" style="margin-top:20px;">
            <div class="card-header">
                <h2 class="card-title">Configureer watchlist</h2>
<<<<<<< Updated upstream
                <div class="card-meta">Selecteer bedrijven en metrics.</div>
            </div>

            <div class="card-body">

                <form method="POST">
=======
                <div class="card-meta">Selecteer bedrijven & metrics</div>
            </div>

            <div class="card-body">
                <form method="POST" class="watchlist-config-form">
>>>>>>> Stashed changes
                    <input type="hidden" name="form_type" value="watchlist_config">

                    <div class="grid-2">

                        <!-- BEDRIJVEN -->
                        <div>
                            <h3>Bedrijven</h3>
<<<<<<< Updated upstream
                            <ul class="soft-list" style="max-height:180px; overflow:auto;">
                                {% for c in companies %}
                                    <li>
                                        <label>
                                            <input type="checkbox" name="companies" value="{{ c.company_id }}"
                                                {% if c.company_id in session.get('watchlist_companies', []) %}checked{% endif %}>
                                            {{ c.name }}
                                        </label>
                                    </li>
=======
                            <ul class="soft-list" style="max-height:180px; overflow:auto;">
                                {% for c in companies %}
                                <li>
                                    <label style="display:flex;align-items:center;gap:6px;">
                                        <input type="checkbox" name="companies" value="{{ c.company_id }}"
                                            {% if c.company_id in session.get('watchlist_companies',[]) %}checked{% endif %}>
                                        {{ c.name }}
                                    </label>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>

                        <div>
                            <h3>Metrics</h3>
                            <ul class="soft-list" style="max-height:180px; overflow:auto;">
                                {% for m in metric_options %}
                                <li>
                                    <label style="display:flex;align-items:center;gap:6px;">
                                        <input type="checkbox" name="metrics" value="{{ m }}"
                                            {% if m in metrics_selected %}checked{% endif %}>
                                        {{ m }}
                                    </label>
                                </li>
>>>>>>> Stashed changes
                                {% endfor %}
                            </ul>
                        </div>

                        <!-- METRICS -->
                        <div>
                            <h3>Metrics</h3>
                            <ul class="soft-list">
                                {% for m in metric_options %}
                                    <li>
                                        <label>
                                            <input type="checkbox" name="metrics" value="{{ m }}"
                                                {% if m in metrics_selected %}checked{% endif %}>
                                            {{ m }}
                                        </label>
                                    </li>
                                {% endfor %}
                            </ul>
                        </div>

                    </div>

<<<<<<< Updated upstream
                    <button class="button" style="margin-top:12px;">Watchlist opslaan</button>
=======
                    <button type="submit" class="button" style="margin-top:10px;">Opslaan</button>
>>>>>>> Stashed changes
                </form>

            </div>
        </section>

        <!-- ALERTS -->
        <section class="card card-muted soft-shadow fade-in">
            <div class="card-header">
                <h2 class="card-title">Recente meldingen</h2>
<<<<<<< Updated upstream
=======
                <div class="card-meta">Mock data</div>
>>>>>>> Stashed changes
            </div>

            <div class="card-body">
                {% if alerts %}
                    {% for alert in alerts %}
                        <div class="alert">{{ alert }}</div>
                    {% endfor %}
                {% else %}
                    <p class="subtitle">Geen nieuwe meldingen.</p>
                {% endif %}
            </div>
        </section>

    </main>
</div>
</body>
</html>
<<<<<<< Updated upstream
=======





















>>>>>>> Stashed changes
