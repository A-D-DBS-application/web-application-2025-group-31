{% extends "base.html" %}
{% block title %}Nieuwe Analyse | Rival{% endblock %}

{% block content %}

<div class="topbar">
  <div class="topbar-left">
    <h1>Nieuwe Webanalyse</h1>
    <p class="subtitle">Plak hieronder een website URL, kies optioneel een sector. Rival analyseert automatisch.</p>
  </div>
</div>

{% if result and result.error %}
  <p class="alert">‚ùå {{ result.error }}</p>
{% endif %}

<section class="card soft-shadow">
  <div class="card-header">
    <h2 class="card-title">Analyse starten</h2>
    <div class="card-meta">Scraping + AI baseline wordt automatisch opgeslagen.</div>
  </div>

  <div class="card-body">
    <form method="POST" class="auth-form" id="scrapeForm">

      <label>Website URL</label>
      <input
        type="text"
        name="url"
        placeholder="https://voorbeeld.nl"
        required
        value="{{ request.args.get('url', '') }}"
      >

      <label class="mt-10">Sector (optioneel)</label>
      <select name="sector_id" class="form-control">
        <option value="">-- kies een sector --</option>
        {% for s in sectors %}
          <option value="{{ s.sector_id }}">{{ s.name }}</option>
        {% endfor %}
      </select>

      <button class="button full mt-14" type="submit">
        Analyse uitvoeren
      </button>
    </form>
  </div>
</section>

<!-- LOADER -->
<div id="loadingSpinner" class="spinner-overlay">
  <div class="spinner"></div>
</div>

{% endblock %}

{% block scripts %}
<script>
  document.addEventListener("DOMContentLoaded", function() {
    const form = document.getElementById("scrapeForm");
    const spinner = document.getElementById("loadingSpinner");

    if (form && spinner) {
      form.addEventListener("submit", function() {
        spinner.classList.add("active");
      });
    }
  });
</script>
{% endblock %}










